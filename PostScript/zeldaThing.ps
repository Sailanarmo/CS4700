%!PS

/inch { 72 mul } def

/sierpinski%p (order)==> Sierpinski triangle fractal
{/p exch def /t p 1 add array def /a 1.7320508 def
1.415 setmiterlimit
0 1 p{/m exch def
0 1 3 m exp 1 sub{/n exch def
/n1 n cvi def
0 1 m 1 sub{/l exch def
t l n1 3 mod put /n1 n1 3 idiv def
}for%l
/x 0 def /y 0 def
0 1 m 1 sub{/k exch def
/x x 4 t k get mul 1 add 30 mul cos 2 k exp div add def
/y y 4 t k get mul 1 add 30 mul sin 2 k exp div add def
}for%k
/u1 x a 2 m 1 add exp div add def /u2 x a 2 m 1 add exp div sub def
/v1 y 1 2 m 1 add exp div sub def /v2 y 1 2 m exp div add def
u1 s v1 s moveto x s v2 s lineto u2 s v1 s lineto u1 s v1 s lineto
}for%n
}for%m
}bind def

/s{100 mul }def % scaling
4 inch 2 inch translate
5 sierpinski stroke
a neg s 1 s moveto a s 1 s lineto 0 -2 s lineto closepath stroke
showpage
